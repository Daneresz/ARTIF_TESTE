<%- include('../cabecalho.ejs') %>
    <div style="margin-bottom: 16px;">
        <a href="/artes" style="text-decoration: none; color: #007bff; font-weight: bold;">ðŸŽ¨ Ver Artes</a>
        &nbsp;&nbsp;
        <a href="/artista" style="text-decoration: none; color: #007bff; font-weight: bold;">ðŸŽ¤ Ver Artistas</a>
    </div>
    <h1>ðŸ“± Posts</h1>
    <form method="get" action="/posts" style="margin-bottom: 16px;">
        <input type="text" name="busca" placeholder="Pesquisar por TÃ­tulo ou Artista"
            value="<%= typeof busca !== 'undefined' ? busca : '' %>">
        <button type="submit">Buscar</button>
    </form>
    <div class="music-list">
        <% if (Posts && Posts.length > 0) { %>
            <% Posts.forEach(post => { %>
                <div class="music-item">
                    <div class="music-summary">
                        <h3>
                            <%= post.titulo %>
                        </h3>
                        <button type="button" class="expand-btn">Expanda</button>
                    </div>
                    <div class="music-details" style="display:none; margin-top:8px;">
                        <div style="display:flex; gap:16px; align-items:flex-start;">
                            <div>
                                <% if (post.imagem) { %>
                                    <img src="<%= post.imagem %>" alt="post" style="width:120px;height:auto">
                                <% } %>
                            </div>
                            <div>
                                <p><strong>Artista:</strong>
                                    <%= post.artista %>
                                </p>
                                <p><strong>Artes:</strong>
                                    <% if (post.artes && post.artes.length > 0) { %>
                                        <%= post.artes.join(', ') %>
                                    <% } %>
                                </p>
                                <% if (post.descricao) { %>
                                    <p><strong>DescriÃ§Ã£o:</strong> <br>
                                    <pre style="white-space:pre-wrap"><%= post.descricao %></pre>
                                    </p>
                                <% } %>
                            </div>
                        </div>
                    </div>
                </div>
            <% }) %>
        <% } else { %>
            <p>Nenhum post encontrado.</p>
        <% } %>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('.music-item').forEach(function (item) {
                var btn = item.querySelector('.expand-btn');
                var details = item.querySelector('.music-details');
                if (!btn || !details) return;
                btn.addEventListener('click', function () {
                    var isHidden = details.style.display === 'none' || details.style.display === '';
                    details.style.display = isHidden ? 'block' : 'none';
                    btn.textContent = isHidden ? 'Fechar' : 'Expanda';
                });
            });
        });
    </script>
    <%- include('../rodape.ejs') %>
